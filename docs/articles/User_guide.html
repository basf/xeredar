<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="xeredar">
<title>User guide • xeredar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="User guide">
<meta property="og:description" content="xeredar">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">xeredar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/User_guide.html">User guide</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>User guide</h1>
            
      
      
      <div class="d-none name"><code>User_guide.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>The package xeredar is an R-package for analysis of the New Approach
Methodology (NAM) assays of XETA (Xenopus Eleutheroembryonic Thyroid),
RADAR (Rapid Androgen Disruption Activity Reporter) and REACTIV (Rapid
Estrogen ACTivity In Vivo) for assessing endocrine effects of chemicals
on the thyroid, androgen/steroid and estrogen axis. The functionality is
based on the SAS-script recommended in the Annex 13 of OECD test
guideline No. 248 of the XETA assay (<a href="https://www.oecd-ilibrary.org/environment/tg-248-xenopus-eleutheroembryonic-thyroid-assay-xeta_a13f80ee-en" class="external-link">2019</a>),
written by John Green.</p>
</div>
<div class="section level2">
<h2 id="data-requirements">Data requirements<a class="anchor" aria-label="anchor" href="#data-requirements"></a>
</h2>
<p>Data frames that are supposed to be analyzed with xeredar needs to
fulfill certain requirements. The data frame or tibble needs to contain
the following column headers:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">xeredar</span><span class="fu">::</span><span class="va"><a href="../reference/testDataSpiked.html">testDataSpiked</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Replicate</th>
<th align="left">Treatment</th>
<th align="left">Row</th>
<th align="right">Fluor</th>
<th align="left">Conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">11</td>
<td align="left">1</td>
<td align="left">0 + T3</td>
<td align="left">4</td>
<td align="right">19.768</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">12</td>
<td align="left">1</td>
<td align="left">0 + T3</td>
<td align="left">4</td>
<td align="right">27.928</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">13</td>
<td align="left">1</td>
<td align="left">0 + T3</td>
<td align="left">4</td>
<td align="right">29.592</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">14</td>
<td align="left">1</td>
<td align="left">0 + T3</td>
<td align="left">4</td>
<td align="right">22.816</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">15</td>
<td align="left">1</td>
<td align="left">0 + T3</td>
<td align="left">4</td>
<td align="right">26.080</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">16</td>
<td align="left">1</td>
<td align="left">0 + T3</td>
<td align="left">4</td>
<td align="right">25.332</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>The type of each column should be accordingly:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="fu">xeredar</span><span class="fu">::</span><span class="va"><a href="../reference/testDataSpiked.html">testDataSpiked</a></span>, <span class="va">class</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Replicate</th>
<th align="left">Treatment</th>
<th align="left">Row</th>
<th align="left">Fluor</th>
<th align="left">Conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">factor</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">numeric</td>
<td align="left">ordered</td>
</tr>
<tr class="even">
<td align="left">factor</td>
<td align="left">character</td>
<td align="left">character</td>
<td align="left">numeric</td>
<td align="left">factor</td>
</tr>
</tbody>
</table>
<p><strong>Replicate</strong> (i.e. run), <strong>Treatment</strong>
(i.e. a unique name for each treatment level in either spiked or
unspiked mode) and <strong>Row</strong> (i.e. exposure vessel) can
either be <em>factor</em> or <em>character</em> columns, but
<strong>Fluor</strong> (i.e. measured fluorescence) must always be
<em>numeric</em> and <strong>Conc</strong> (i.e. concentration of test
item) must always contain <em>ordered factors</em>. The order of the
columns is not relevant.</p>
<p><strong>Replicate</strong>, <strong>Treatment</strong> and
<strong>Row</strong> can either be <em>factor</em> or <em>character</em>
columns, but <strong>Fluor</strong> must always be <em>numeric</em> and
<strong>Conc</strong> must always contain <em>ordered factors</em>. The
order of the columns is not relevant. It is important that the decimal
separator is a period instead of a comma.</p>
<p>When simply aiming to use the <code><a href="../reference/data_prep.html">data_prep()</a></code> function, the
data frame needs to either contain spiked treatments or unspiked
treatments. When still having spiked and unspiked treatments in one data
frame they should be separated. Imagine you have a XETA data frame (dat)
which contains spiked and unspiked treatments as well as the T4 positive
control. The T3 or T4 additions are designated by “T3” and “T4” in the
<strong>Treatment</strong> column. The spiked and unspiked datasets
could quickly be subset using the following code:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datSpiked</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"T3"</span>,<span class="va">dat</span><span class="op">$</span><span class="va">Treatment</span><span class="op">)</span>,<span class="op">]</span> <span class="co"># spiked data </span></span>
<span></span>
<span><span class="va">datUnspiked</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">dat</span>,<span class="va">datSpiked</span><span class="op">)</span></span>
<span><span class="va">datUnspiked</span> <span class="op">&lt;-</span> <span class="va">datUnspiked</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">datUnspiked</span><span class="op">$</span><span class="va">Treatment</span> <span class="op">!=</span> <span class="st">"T4"</span><span class="op">)</span>,<span class="op">]</span> <span class="co"># unspiked data</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-default-xeta-analysis">Running default XETA analysis<a class="anchor" aria-label="anchor" href="#running-default-xeta-analysis"></a>
</h2>
<p>To demonstrate how to run XETA analysis, we will use one of the data
sets by the French lab containing the spiked and unspiked measurements
from the XETA ring test as included in OECD test guideline No. 248 of
the XETA assay (<a href="https://www.oecd-ilibrary.org/environment/tg-248-xenopus-eleutheroembryonic-thyroid-assay-xeta_a13f80ee-en" class="external-link">2019</a>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xeta_spiked</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="va"><a href="../reference/valid_data_xeta.html">valid_data_xeta</a></span><span class="op">[[</span><span class="st">"ptu_france_spiked"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">xeta_unspiked</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="va"><a href="../reference/valid_data_xeta.html">valid_data_xeta</a></span><span class="op">[[</span><span class="st">"ptu_france_unspiked"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>The default XETA analysis can be run using the
<code><a href="../reference/data_prep.html">data_prep()</a></code> function with either spiked or unspiked data.
This function automatically decides whether trimming, outlier removal
and/or transformations are conducted following the manuscript
(Spyridonov et al. unpublished). The actual analysis is carried out by
the <code><a href="../reference/ana.html">ana()</a></code> function. The <code><a href="../reference/ana.html">ana()</a></code> function is
called by the <code><a href="../reference/data_prep.html">data_prep()</a></code> function and does not need to be
called separately. For this dataset, the exposure well ID (Row of the 96
well plate) is not recorded, therefore, we set the <code>row</code>
argument to <code>FALSE</code>. In this case, we use the reduced mixed
ANOVA model where the exposure well ID is not included as a random
effect. Please specify <code>row=TRUE</code> if the exposure well ID is
recorded and you want to use the full mixed ANOVA model.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">xeta_spiked_result</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/data_prep.html">data_prep</a></span><span class="op">(</span>dataframe <span class="op">=</span> <span class="va">xeta_spiked</span>, row <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">xeta_unspiked_result</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/data_prep.html">data_prep</a></span><span class="op">(</span>dataframe <span class="op">=</span> <span class="va">xeta_unspiked</span>, row<span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Here we use the spike data as an example to demonstrate the output of
the <code><a href="../reference/data_prep.html">data_prep()</a></code> function.</p>
<p>The outputs of the <code><a href="../reference/data_prep.html">data_prep()</a></code> function are lists
containing the following elements:</p>
<ul>
<li>A reasoning for the recommended transformation and trimming. The raw
data should be used for the analysis because the residuals of the mixed
ANOVA are normally distributed and show homogeneous variances among
treatment groups.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">Justify</span></span>
<span><span class="co">#&gt; [1] "The raw data should be used for the analysis because\n                  the residuals of the mixed ANOVA are normally\n                  distributed and show homogeneous variances\n                  among treatment groups."</span></span></code></pre></div>
<ul>
<li>A data frame of the processed data (e.g. raw data, trimmed,
transformed, or outlier removed) used for actual statistical testing
following the reasoning. The box plots of the processed data per
run/replicate (i.e. each panel represents each run/replicate) are also
provided for visual inspection.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">ProcessedData</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Replicate</th>
<th align="left">Treatment</th>
<th align="right">Fluor</th>
<th align="left">Conc</th>
<th align="left">Country</th>
<th align="left">Substance</th>
<th align="left">Spiked</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">FETAXT3</td>
<td align="right">4989.533</td>
<td align="left">0</td>
<td align="left">france</td>
<td align="left">ptu</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">FETAXT3</td>
<td align="right">5002.533</td>
<td align="left">0</td>
<td align="left">france</td>
<td align="left">ptu</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">FETAXT3</td>
<td align="right">6331.533</td>
<td align="left">0</td>
<td align="left">france</td>
<td align="left">ptu</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">FETAXT3</td>
<td align="right">4645.533</td>
<td align="left">0</td>
<td align="left">france</td>
<td align="left">ptu</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">FETAXT3</td>
<td align="right">4977.533</td>
<td align="left">0</td>
<td align="left">france</td>
<td align="left">ptu</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">FETAXT3</td>
<td align="right">6229.533</td>
<td align="left">0</td>
<td align="left">france</td>
<td align="left">ptu</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">BoxPlots</span></span></code></pre></div>
<p><img src="User_guide_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<ul>
<li>Summary tables of the processed data (per replicate and
overall)</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">SummaryDF_Rep</span>, caption<span class="op">=</span><span class="st">"Summary statistics of fluorescence in different concentrations of test item per replicate"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Summary statistics of fluorescence in different concentrations
of test item per replicate</caption>
<colgroup>
<col width="7%">
<col width="14%">
<col width="4%">
<col width="12%">
<col width="26%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th align="left">Conc</th>
<th align="left">Replicate</th>
<th align="right">N</th>
<th align="right">Mean</th>
<th align="right">Standard deviation</th>
<th align="right">Coefficient of variation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">1</td>
<td align="right">19</td>
<td align="right">4651.060</td>
<td align="right">944.7420</td>
<td align="right">0.2031240</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">2</td>
<td align="right">20</td>
<td align="right">4024.300</td>
<td align="right">603.6731</td>
<td align="right">0.1500070</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">3</td>
<td align="right">19</td>
<td align="right">4952.225</td>
<td align="right">1179.3597</td>
<td align="right">0.2381475</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">1</td>
<td align="right">19</td>
<td align="right">3854.137</td>
<td align="right">828.3944</td>
<td align="right">0.2149364</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">2</td>
<td align="right">20</td>
<td align="right">4557.867</td>
<td align="right">558.4921</td>
<td align="right">0.1225337</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">3</td>
<td align="right">19</td>
<td align="right">4720.819</td>
<td align="right">619.8992</td>
<td align="right">0.1313118</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">1</td>
<td align="right">19</td>
<td align="right">4671.428</td>
<td align="right">976.9674</td>
<td align="right">0.2091368</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="left">2</td>
<td align="right">19</td>
<td align="right">4486.538</td>
<td align="right">783.8641</td>
<td align="right">0.1747147</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">3</td>
<td align="right">20</td>
<td align="right">5421.433</td>
<td align="right">703.9490</td>
<td align="right">0.1298456</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">1</td>
<td align="right">20</td>
<td align="right">4573.083</td>
<td align="right">946.2029</td>
<td align="right">0.2069070</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="left">2</td>
<td align="right">19</td>
<td align="right">4329.538</td>
<td align="right">827.4898</td>
<td align="right">0.1911266</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">3</td>
<td align="right">19</td>
<td align="right">5106.849</td>
<td align="right">876.5940</td>
<td align="right">0.1716507</td>
</tr>
<tr class="odd">
<td align="left">30</td>
<td align="left">1</td>
<td align="right">20</td>
<td align="right">5391.183</td>
<td align="right">809.5849</td>
<td align="right">0.1501683</td>
</tr>
<tr class="even">
<td align="left">30</td>
<td align="left">2</td>
<td align="right">19</td>
<td align="right">4556.275</td>
<td align="right">694.1698</td>
<td align="right">0.1523547</td>
</tr>
<tr class="odd">
<td align="left">30</td>
<td align="left">3</td>
<td align="right">19</td>
<td align="right">5164.691</td>
<td align="right">763.8837</td>
<td align="right">0.1479050</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="left">1</td>
<td align="right">19</td>
<td align="right">5181.060</td>
<td align="right">858.5454</td>
<td align="right">0.1657085</td>
</tr>
<tr class="odd">
<td align="left">100</td>
<td align="left">2</td>
<td align="right">19</td>
<td align="right">5124.381</td>
<td align="right">733.4611</td>
<td align="right">0.1431317</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="left">3</td>
<td align="right">20</td>
<td align="right">6048.083</td>
<td align="right">959.5900</td>
<td align="right">0.1586602</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">SummaryDF</span>, caption<span class="op">=</span><span class="st">"Summary statistics of fluorescence in different concentrations of test item of all replicates"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Summary statistics of fluorescence in different concentrations
of test item of all replicates</caption>
<thead><tr class="header">
<th align="left">Conc</th>
<th align="right">N</th>
<th align="right">Mean</th>
<th align="right">Standard deviation</th>
<th align="right">Coefficient of variation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">58</td>
<td align="right">4533.593</td>
<td align="right">998.2901</td>
<td align="right">0.2201984</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">58</td>
<td align="right">4380.715</td>
<td align="right">764.2147</td>
<td align="right">0.1744498</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">58</td>
<td align="right">4869.483</td>
<td align="right">910.7568</td>
<td align="right">0.1870336</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="right">58</td>
<td align="right">4668.156</td>
<td align="right">928.9066</td>
<td align="right">0.1989879</td>
</tr>
<tr class="odd">
<td align="left">30</td>
<td align="right">58</td>
<td align="right">5043.483</td>
<td align="right">825.4425</td>
<td align="right">0.1636652</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="right">58</td>
<td align="right">5461.466</td>
<td align="right">945.7370</td>
<td align="right">0.1731654</td>
</tr>
</tbody>
</table>
<ul>
<li>Tables of results evaluated using increasing/decreasing Williams
test and/or Dunnett’s test, if applicable.</li>
</ul>
<p>In the the Williams’ test result tables, <em>Y.Tilde</em> is the
amalgamated mean of the fluorescence in each treatment group,
<em>Y0</em> is the mean of the control fluorescence, <em>DIFF</em> is
the estimated difference between the treatment and the control,
<em>SE_DIFF</em> is the standard error of the Williams’ test,
<em>DF</em> is the degrees of freedom for Williams’ test, <em>WILL
Incr</em> or <em>Will Decr</em> is the Williams’ test statistic,
<em>crit Val</em> is the critical value of Williams distribution,
<em>Sign</em> suggests if there is significant difference between the
treatment and the control, and <em>%Incr</em> is the percent increase of
the fluorescence compared to the control.</p>
<p>In the Dunnett’s test result table, <em>Estimate</em> is the
estimated difference between the treatment and the control, <em>SE</em>
is the standard error of the mixed ANOVA model, <em>t value</em> is the
Dunnett’s test statistic, <em>adj p</em> is the adjusted p value and
<em>%Incr</em> is the percent increase of the fluorescence compared to
the control.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">WilliamsIncrease</span>, caption<span class="op">=</span><span class="st">"Increasing Williams' test"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Increasing Williams’ test</caption>
<colgroup>
<col width="16%">
<col width="5%">
<col width="8%">
<col width="9%">
<col width="10%">
<col width="9%">
<col width="3%">
<col width="11%">
<col width="9%">
<col width="6%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Conc</th>
<th align="right">Y.Tilde</th>
<th align="right">Y0</th>
<th align="right">DIFF Incr</th>
<th align="right">SE_DIFF</th>
<th align="right">DF</th>
<th align="right">WILL Incr</th>
<th align="right">crit Val</th>
<th align="left">Sign</th>
<th align="right">% Incr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conc100 - Conc0</td>
<td align="left">100</td>
<td align="right">5461.47</td>
<td align="right">4533.593</td>
<td align="right">927.8769</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">3.7146758</td>
<td align="right">1.971</td>
<td align="left">TRUE</td>
<td align="right">20.466613</td>
</tr>
<tr class="even">
<td align="left">Conc30 - Conc0</td>
<td align="left">30</td>
<td align="right">5043.48</td>
<td align="right">4533.593</td>
<td align="right">509.8869</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">2.0412886</td>
<td align="right">1.965</td>
<td align="left">TRUE</td>
<td align="right">11.246933</td>
</tr>
<tr class="odd">
<td align="left">Conc10 - Conc0</td>
<td align="left">10</td>
<td align="right">4768.82</td>
<td align="right">4533.593</td>
<td align="right">235.2269</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">0.9417108</td>
<td align="right">1.956</td>
<td align="left">FALSE</td>
<td align="right">2.968123</td>
</tr>
<tr class="even">
<td align="left">Conc3 - Conc0</td>
<td align="left">3</td>
<td align="right">4768.82</td>
<td align="right">4533.593</td>
<td align="right">235.2269</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">0.9417108</td>
<td align="right">1.940</td>
<td align="left">FALSE</td>
<td align="right">7.408918</td>
</tr>
<tr class="odd">
<td align="left">Conc1 - Conc0</td>
<td align="left">1</td>
<td align="right">4380.72</td>
<td align="right">4533.593</td>
<td align="right">-152.8731</td>
<td align="right">249.7845</td>
<td align="right">10</td>
<td align="right">-0.6120201</td>
<td align="right">1.908</td>
<td align="left">FALSE</td>
<td align="right">-3.372111</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">WilliamsDecrease</span>, caption<span class="op">=</span><span class="st">"Decreasing Williams' test"</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>Decreasing Williams’ test</caption>
<colgroup>
<col width="16%">
<col width="5%">
<col width="8%">
<col width="9%">
<col width="10%">
<col width="9%">
<col width="3%">
<col width="10%">
<col width="9%">
<col width="6%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Conc</th>
<th align="right">Y.Tilde</th>
<th align="right">Y0</th>
<th align="right">DIFF Decr</th>
<th align="right">SE_DIFF</th>
<th align="right">DF</th>
<th align="right">WILL Decr</th>
<th align="right">crit Val</th>
<th align="left">Sign</th>
<th align="right">% Incr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conc100 - Conc0</td>
<td align="left">100</td>
<td align="right">4884.66</td>
<td align="right">4533.593</td>
<td align="right">-351.0669</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">-1.405466</td>
<td align="right">1.971</td>
<td align="left">FALSE</td>
<td align="right">20.466613</td>
</tr>
<tr class="even">
<td align="left">Conc30 - Conc0</td>
<td align="left">30</td>
<td align="right">4884.66</td>
<td align="right">4533.593</td>
<td align="right">-351.0669</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">-1.405466</td>
<td align="right">1.965</td>
<td align="left">FALSE</td>
<td align="right">11.246933</td>
</tr>
<tr class="odd">
<td align="left">Conc10 - Conc0</td>
<td align="left">10</td>
<td align="right">4884.66</td>
<td align="right">4533.593</td>
<td align="right">-351.0669</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">-1.405466</td>
<td align="right">1.956</td>
<td align="left">FALSE</td>
<td align="right">2.968123</td>
</tr>
<tr class="even">
<td align="left">Conc3 - Conc0</td>
<td align="left">3</td>
<td align="right">4884.66</td>
<td align="right">4533.593</td>
<td align="right">-351.0669</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">-1.405466</td>
<td align="right">1.940</td>
<td align="left">FALSE</td>
<td align="right">7.408918</td>
</tr>
<tr class="odd">
<td align="left">Conc1 - Conc0</td>
<td align="left">1</td>
<td align="right">4884.66</td>
<td align="right">4533.593</td>
<td align="right">-351.0669</td>
<td align="right">249.7845</td>
<td align="right">10</td>
<td align="right">-1.405479</td>
<td align="right">1.908</td>
<td align="left">FALSE</td>
<td align="right">-3.372111</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">Dunnetts</span>, caption<span class="op">=</span><span class="st">"Dunnett's test"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Dunnett’s test</caption>
<colgroup>
<col width="23%">
<col width="14%">
<col width="13%">
<col width="4%">
<col width="15%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t value</th>
<th align="right">adj p</th>
<th align="right">% Incr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conc1 - Conc0</td>
<td align="right">-160.4067</td>
<td align="right">249.7845</td>
<td align="right">10</td>
<td align="right">-0.6421806</td>
<td align="right">0.9458404</td>
<td align="right">-3.372111</td>
</tr>
<tr class="even">
<td align="left">Conc3 - Conc0</td>
<td align="right">320.1063</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">1.2815181</td>
<td align="right">0.5970718</td>
<td align="right">7.408918</td>
</tr>
<tr class="odd">
<td align="left">Conc10 - Conc0</td>
<td align="right">128.8281</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">0.5157522</td>
<td align="right">0.9769722</td>
<td align="right">2.968123</td>
</tr>
<tr class="even">
<td align="left">Conc30 - Conc0</td>
<td align="right">499.2993</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">1.9989021</td>
<td align="right">0.2367993</td>
<td align="right">11.246933</td>
</tr>
<tr class="odd">
<td align="left">Conc100 - Conc0</td>
<td align="right">911.7088</td>
<td align="right">249.7868</td>
<td align="right">10</td>
<td align="right">3.6499482</td>
<td align="right">0.0174131</td>
<td align="right">20.466613</td>
</tr>
</tbody>
</table>
<ul>
<li>Further information about the normality test (Shapiro-Wilk), the
homogeneity of variance test (Levene’s test) of residuals of the mixed
ANOVA model, the monotonicity test and the model fit.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">NormalityTest</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Shapiro-Wilk normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  stats::resid(mixedaov)</span></span>
<span><span class="co">#&gt; W = 0.99186, p-value = 0.05343</span></span>
<span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">LeveneTest</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;   statistic p.value    df df.residual</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0.759   0.580     5         342</span></span>
<span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">`Monotonicity Test`</span></span>
<span><span class="co">#&gt;        Test t value Pr(&gt;|t|) Significance</span></span>
<span><span class="co">#&gt; 1    Linear    6.49  &lt;0.0001          ***</span></span>
<span><span class="co">#&gt; 2 Quadratic    2.14   0.0335            *</span></span>
<span><span class="va">xeta_spiked_result</span><span class="op">$</span><span class="va">MixedAnova</span></span>
<span><span class="co">#&gt; Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: Fluor ~ Conc + (1 | Replicate) + (1 | Replicate:Conc)</span></span>
<span><span class="co">#&gt;    Data: dataframe</span></span>
<span><span class="co">#&gt; REML criterion at convergence: 5608.294</span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups         Name        Std.Dev.</span></span>
<span><span class="co">#&gt;  Replicate:Conc (Intercept) 241.1   </span></span>
<span><span class="co">#&gt;  Replicate      (Intercept) 350.5   </span></span>
<span><span class="co">#&gt;  Residual                   827.7   </span></span>
<span><span class="co">#&gt; Number of obs: 348, groups:  Replicate:Conc, 18; Replicate, 3</span></span>
<span><span class="co">#&gt; Fixed Effects:</span></span>
<span><span class="co">#&gt; (Intercept)       Conc.L       Conc.Q       Conc.C       Conc^4       Conc^5  </span></span>
<span><span class="co">#&gt;      4824.2        758.5        264.5         52.6        149.8       -270.8</span></span></code></pre></div>
<p><em>The list output from running the data_prep() function can be
summarized with the data_summary() function.</em></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/data_summary.html">data_summary</a></span><span class="op">(</span><span class="va">xeta_spiked_result</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">1</th>
<th align="left">3</th>
<th align="left">10</th>
<th align="left">30</th>
<th align="left">100</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Replicate 1</td>
<td align="left">-17.13</td>
<td align="left">0.44</td>
<td align="left">-1.68</td>
<td align="left">15.91</td>
<td align="left">11.4</td>
</tr>
<tr class="even">
<td align="left">Replicate 2</td>
<td align="left">13.26</td>
<td align="left">11.49</td>
<td align="left">7.58</td>
<td align="left">13.22</td>
<td align="left">27.34</td>
</tr>
<tr class="odd">
<td align="left">Replicate 3</td>
<td align="left">-4.67</td>
<td align="left">9.47</td>
<td align="left">3.12</td>
<td align="left">4.29</td>
<td align="left">22.13</td>
</tr>
<tr class="even">
<td align="left">Pooled</td>
<td align="left">-3.37</td>
<td align="left">7.41</td>
<td align="left">2.97</td>
<td align="left">11.25</td>
<td align="left">20.47</td>
</tr>
<tr class="odd">
<td align="left">Dunnett</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">*</td>
</tr>
<tr class="even">
<td align="left">IncreasingWilliams</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">*</td>
<td align="left">*</td>
</tr>
<tr class="odd">
<td align="left">DecreasingWilliams</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="running-default-radar-analysis">Running default RADAR analysis<a class="anchor" aria-label="anchor" href="#running-default-radar-analysis"></a>
</h2>
<p>To demonstrate how to run RADAR analysis, we will use one of the data
sets by the Pos_mDHT_Fraunhofer_RADAR containing the spiked and unspiked
measurements from the RADAR study validation in the lab Fraunhofer with
an androgen axis active chemical.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">radar_spiked</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="va"><a href="../reference/Pos_mDHT_Fraunhofer_RADAR_Spiked.html">Pos_mDHT_Fraunhofer_RADAR_Spiked</a></span></span>
<span><span class="va">radar_unspiked</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="va"><a href="../reference/Pos_mDHT_Fraunhofer_RADAR_Unspiked.html">Pos_mDHT_Fraunhofer_RADAR_Unspiked</a></span></span></code></pre></div>
<p>The default radar analysis can be run using the
<code><a href="../reference/data_prep.html">data_prep()</a></code> function with either spiked or unspiked data.
This function automatically decides whether trimming, outlier removal
and/or transformations are conducted following the manuscript
(Spyridonov et al. unpublished). The actual analysis is carried out by
the <code><a href="../reference/ana.html">ana()</a></code> function. The <code><a href="../reference/ana.html">ana()</a></code> function is
called by the <code><a href="../reference/data_prep.html">data_prep()</a></code> function and does not need to be
called separately. the analysis the RADAR assay follows the description
of the Method 2 (the mixed ANOVA approach) in the Annex 8: methods for
the statistical analysis of RADAR assay data of the OECD TG 251 (<a href="https://www.oecd-ilibrary.org/environment/test-no-251-rapid-androgen-disruption-activity-reporter-radar-assay_da264d82-en" class="external-link">2022</a>).
For this dataset, the exposure well ID (Row of the 96 well plate) is not
recorded, therefore, we set the <code>row</code> argument to
<code>FALSE</code>. In this case, we use the reduced mixed ANOVA model
where the exposure well ID is not included as a random effect. Please
specify <code>row=TRUE</code> if the exposure well ID is recorded and
you want to use the full mixed ANOVA model. Trimming is not
required.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">radar_spiked_result</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/data_prep.html">data_prep</a></span><span class="op">(</span>dataframe <span class="op">=</span> <span class="va">radar_spiked</span>, row <span class="op">=</span> <span class="cn">FALSE</span>, trimming<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">radar_unspiked_result</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/data_prep.html">data_prep</a></span><span class="op">(</span>dataframe <span class="op">=</span> <span class="va">radar_unspiked</span>, row<span class="op">=</span> <span class="cn">FALSE</span>, trimming<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Here we use the spike data as an example to demonstrate the output of
the <code><a href="../reference/data_prep.html">data_prep()</a></code> function.</p>
<p>The outputs of the <code><a href="../reference/data_prep.html">data_prep()</a></code> function are lists
containing the following elements:</p>
<ul>
<li>A reasoning for the recommended transformation and trimming. The raw
data (without trimming or outlier removal) where the fluorescence values
are box-cox transformed should be used for the analysis because only
after box-cox transformation, the residuals of the mixed ANOVA are
normally distributed and have homogeneous variances among treatment
groups.</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">Justify</span></span>
<span><span class="co">#&gt; [1] "The raw data (without trimming or outlier removal)\n                    where the fluorescence values are box-cox transformed\n                    should be used for the analysis because only after\n                    box-cox transformation, the residuals of the mixed\n                    ANOVA are normally distributed and have homogeneous\n                    variances among treatment groups."</span></span></code></pre></div>
<ul>
<li>A data frame of the processed data (e.g. raw data, transformed, or
outlier removed) used for actual statistical testing following the
reasoning. The box plots of the processed data per run/replicate
(i.e. each panel represents each run/replicate) are also provided for
visual inspection.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">ProcessedData</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Replicate</th>
<th align="left">Treatment</th>
<th align="right">Fluor</th>
<th align="left">Conc</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">MT_0</td>
<td align="right">113152</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">mDHT-1µg/L+MT</td>
<td align="right">708</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">mDHT-2µg/L+MT</td>
<td align="right">2498</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">mDHT-4µg/L+MT</td>
<td align="right">10152</td>
<td align="left">4</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">mDHT-8µg/L+MT</td>
<td align="right">356</td>
<td align="left">8</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">mDHT-16µg/L+MT</td>
<td align="right">4621</td>
<td align="left">16</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">BoxPlots</span></span></code></pre></div>
<p><img src="User_guide_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
<ul>
<li>Summary tables of the processed data (per replicate and
overall)</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">SummaryDF_Rep</span>, caption<span class="op">=</span><span class="st">"Summary statistics of fluorescence in different concentrations of test item per replicate"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Summary statistics of fluorescence in different concentrations
of test item per replicate</caption>
<colgroup>
<col width="7%">
<col width="14%">
<col width="4%">
<col width="12%">
<col width="26%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th align="left">Conc</th>
<th align="left">Replicate</th>
<th align="right">N</th>
<th align="right">Mean</th>
<th align="right">Standard deviation</th>
<th align="right">Coefficient of variation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">1</td>
<td align="right">20</td>
<td align="right">21472.45</td>
<td align="right">39991.342</td>
<td align="right">1.862449</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">2</td>
<td align="right">20</td>
<td align="right">13337.15</td>
<td align="right">34300.658</td>
<td align="right">2.571813</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">3</td>
<td align="right">20</td>
<td align="right">26313.45</td>
<td align="right">35370.046</td>
<td align="right">1.344181</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">1</td>
<td align="right">20</td>
<td align="right">7711.10</td>
<td align="right">10559.058</td>
<td align="right">1.369332</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">2</td>
<td align="right">20</td>
<td align="right">10044.70</td>
<td align="right">13997.692</td>
<td align="right">1.393540</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">3</td>
<td align="right">21</td>
<td align="right">18764.48</td>
<td align="right">27176.392</td>
<td align="right">1.448289</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">1</td>
<td align="right">20</td>
<td align="right">29476.80</td>
<td align="right">44428.181</td>
<td align="right">1.507225</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">2</td>
<td align="right">20</td>
<td align="right">8471.85</td>
<td align="right">10013.423</td>
<td align="right">1.181964</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="left">3</td>
<td align="right">21</td>
<td align="right">37028.38</td>
<td align="right">50456.149</td>
<td align="right">1.362634</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">1</td>
<td align="right">20</td>
<td align="right">16336.90</td>
<td align="right">31480.267</td>
<td align="right">1.926943</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">2</td>
<td align="right">20</td>
<td align="right">14077.65</td>
<td align="right">20278.502</td>
<td align="right">1.440475</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">3</td>
<td align="right">20</td>
<td align="right">22364.45</td>
<td align="right">32556.358</td>
<td align="right">1.455719</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">1</td>
<td align="right">20</td>
<td align="right">5425.90</td>
<td align="right">8478.898</td>
<td align="right">1.562671</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">2</td>
<td align="right">20</td>
<td align="right">8867.10</td>
<td align="right">14750.623</td>
<td align="right">1.663523</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">3</td>
<td align="right">20</td>
<td align="right">21992.45</td>
<td align="right">30246.253</td>
<td align="right">1.375302</td>
</tr>
<tr class="even">
<td align="left">16</td>
<td align="left">1</td>
<td align="right">20</td>
<td align="right">6758.70</td>
<td align="right">8394.210</td>
<td align="right">1.241986</td>
</tr>
<tr class="odd">
<td align="left">16</td>
<td align="left">2</td>
<td align="right">20</td>
<td align="right">7988.10</td>
<td align="right">14300.281</td>
<td align="right">1.790198</td>
</tr>
<tr class="even">
<td align="left">16</td>
<td align="left">3</td>
<td align="right">20</td>
<td align="right">15274.35</td>
<td align="right">19124.161</td>
<td align="right">1.252044</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">SummaryDF</span>, caption<span class="op">=</span><span class="st">"Summary statistics of fluorescence in different concentrations of test item of all replicates"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Summary statistics of fluorescence in different concentrations
of test item of all replicates</caption>
<thead><tr class="header">
<th align="left">Conc</th>
<th align="right">N</th>
<th align="right">Mean</th>
<th align="right">Standard deviation</th>
<th align="right">Coefficient of variation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">60</td>
<td align="right">20374.35</td>
<td align="right">36413.54</td>
<td align="right">1.787224</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">61</td>
<td align="right">12281.48</td>
<td align="right">19154.08</td>
<td align="right">1.559591</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">61</td>
<td align="right">25189.66</td>
<td align="right">40666.43</td>
<td align="right">1.614410</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">60</td>
<td align="right">17593.00</td>
<td align="right">28378.41</td>
<td align="right">1.613052</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="right">60</td>
<td align="right">12095.15</td>
<td align="right">20967.68</td>
<td align="right">1.733561</td>
</tr>
<tr class="even">
<td align="left">16</td>
<td align="right">60</td>
<td align="right">10007.05</td>
<td align="right">14855.60</td>
<td align="right">1.484513</td>
</tr>
</tbody>
</table>
<ul>
<li>Tables of results evaluated using increasing/decreasing Williams
test and/or Dunnett’s test, if applicable.</li>
</ul>
<p>In the the Williams’ test result tables, <em>Y.Tilde</em> is the
amalgamated mean of the fluorescence in each treatment group,
<em>Y0</em> is the mean of the control fluorescence, <em>DIFF</em> is
the estimated difference between the treatment and the control,
<em>SE_DIFF</em> is the standard error of the Williams’ test,
<em>DF</em> is the degrees of freedom for Williams’ test, <em>WILL
Incr</em> or <em>Will Decr</em> is the Williams’ test statistic,
<em>crit Val</em> is the critical value of Williams distribution,
<em>Sign</em> suggests if there is significant difference between the
treatment and the control, and <em>%Incr</em> is the percent increase of
the fluorescence compared to the control.</p>
<p>In the Dunnett’s test result table, <em>Estimate</em> is the
estimated difference between the treatment and the control, <em>SE</em>
is the standard error of the mixed ANOVA model, <em>t value</em> is the
Dunnett’s test statistic, <em>adj p</em> is the adjusted p value and
<em>%Incr</em> is the percent increase of the fluorescence compared to
the control.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">WilliamsIncrease</span>, caption<span class="op">=</span><span class="st">"Increasing Williams' test"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Increasing Williams’ test</caption>
<colgroup>
<col width="15%">
<col width="5%">
<col width="8%">
<col width="9%">
<col width="10%">
<col width="10%">
<col width="3%">
<col width="11%">
<col width="9%">
<col width="6%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Conc</th>
<th align="right">Y.Tilde</th>
<th align="right">Y0</th>
<th align="right">DIFF Incr</th>
<th align="right">SE_DIFF</th>
<th align="right">DF</th>
<th align="right">WILL Incr</th>
<th align="right">crit Val</th>
<th align="left">Sign</th>
<th align="right">% Incr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conc16 - Conc0</td>
<td align="left">16</td>
<td align="right">11.1995</td>
<td align="right">11.24223</td>
<td align="right">-0.04273</td>
<td align="right">0.5230995</td>
<td align="right">10</td>
<td align="right">-0.0816862</td>
<td align="right">1.971</td>
<td align="left">FALSE</td>
<td align="right">-50.88408</td>
</tr>
<tr class="even">
<td align="left">Conc8 - Conc0</td>
<td align="left">8</td>
<td align="right">11.1995</td>
<td align="right">11.24223</td>
<td align="right">-0.04273</td>
<td align="right">0.5230995</td>
<td align="right">10</td>
<td align="right">-0.0816862</td>
<td align="right">1.965</td>
<td align="left">FALSE</td>
<td align="right">-40.63541</td>
</tr>
<tr class="odd">
<td align="left">Conc4 - Conc0</td>
<td align="left">4</td>
<td align="right">11.1995</td>
<td align="right">11.24223</td>
<td align="right">-0.04273</td>
<td align="right">0.5230995</td>
<td align="right">10</td>
<td align="right">-0.0816862</td>
<td align="right">1.956</td>
<td align="left">FALSE</td>
<td align="right">-13.65123</td>
</tr>
<tr class="even">
<td align="left">Conc2 - Conc0</td>
<td align="left">2</td>
<td align="right">11.1995</td>
<td align="right">11.24223</td>
<td align="right">-0.04273</td>
<td align="right">0.5209615</td>
<td align="right">10</td>
<td align="right">-0.0820214</td>
<td align="right">1.940</td>
<td align="left">FALSE</td>
<td align="right">23.63416</td>
</tr>
<tr class="odd">
<td align="left">Conc1 - Conc0</td>
<td align="left">1</td>
<td align="right">10.7566</td>
<td align="right">11.24223</td>
<td align="right">-0.48563</td>
<td align="right">0.5209615</td>
<td align="right">10</td>
<td align="right">-0.9321802</td>
<td align="right">1.908</td>
<td align="left">FALSE</td>
<td align="right">-39.72090</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">WilliamsDecrease</span>, caption<span class="op">=</span><span class="st">"Decreasing Williams' test"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Decreasing Williams’ test</caption>
<colgroup>
<col width="15%">
<col width="5%">
<col width="8%">
<col width="9%">
<col width="10%">
<col width="10%">
<col width="3%">
<col width="11%">
<col width="9%">
<col width="6%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Conc</th>
<th align="right">Y.Tilde</th>
<th align="right">Y0</th>
<th align="right">DIFF Decr</th>
<th align="right">SE_DIFF</th>
<th align="right">DF</th>
<th align="right">WILL Decr</th>
<th align="right">crit Val</th>
<th align="left">Sign</th>
<th align="right">% Incr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conc16 - Conc0</td>
<td align="left">16</td>
<td align="right">10.4996</td>
<td align="right">11.24223</td>
<td align="right">0.74263</td>
<td align="right">0.5230995</td>
<td align="right">10</td>
<td align="right">1.4196726</td>
<td align="right">1.971</td>
<td align="left">FALSE</td>
<td align="right">-50.88408</td>
</tr>
<tr class="even">
<td align="left">Conc8 - Conc0</td>
<td align="left">8</td>
<td align="right">10.6478</td>
<td align="right">11.24223</td>
<td align="right">0.59443</td>
<td align="right">0.5230995</td>
<td align="right">10</td>
<td align="right">1.1363613</td>
<td align="right">1.965</td>
<td align="left">FALSE</td>
<td align="right">-40.63541</td>
</tr>
<tr class="odd">
<td align="left">Conc4 - Conc0</td>
<td align="left">4</td>
<td align="right">11.4661</td>
<td align="right">11.24223</td>
<td align="right">-0.22387</td>
<td align="right">0.5230995</td>
<td align="right">10</td>
<td align="right">-0.4279683</td>
<td align="right">1.956</td>
<td align="left">FALSE</td>
<td align="right">-13.65123</td>
</tr>
<tr class="even">
<td align="left">Conc2 - Conc0</td>
<td align="left">2</td>
<td align="right">11.4661</td>
<td align="right">11.24223</td>
<td align="right">-0.22387</td>
<td align="right">0.5209615</td>
<td align="right">10</td>
<td align="right">-0.4297247</td>
<td align="right">1.940</td>
<td align="left">FALSE</td>
<td align="right">23.63416</td>
</tr>
<tr class="odd">
<td align="left">Conc1 - Conc0</td>
<td align="left">1</td>
<td align="right">11.4661</td>
<td align="right">11.24223</td>
<td align="right">-0.22387</td>
<td align="right">0.5209615</td>
<td align="right">10</td>
<td align="right">-0.4297247</td>
<td align="right">1.908</td>
<td align="left">FALSE</td>
<td align="right">-39.72090</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">Dunnetts</span>, caption<span class="op">=</span><span class="st">"Dunnett's test"</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>Dunnett’s test</caption>
<colgroup>
<col width="21%">
<col width="15%">
<col width="14%">
<col width="4%">
<col width="15%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t value</th>
<th align="right">adj p</th>
<th align="right">% Incr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conc1 - Conc0</td>
<td align="right">-0.4981949</td>
<td align="right">0.5209615</td>
<td align="right">10</td>
<td align="right">-0.9562989</td>
<td align="right">0.8003229</td>
<td align="right">-39.72090</td>
</tr>
<tr class="even">
<td align="left">Conc2 - Conc0</td>
<td align="right">0.8271841</td>
<td align="right">0.5209615</td>
<td align="right">10</td>
<td align="right">1.5878028</td>
<td align="right">0.4159647</td>
<td align="right">23.63416</td>
</tr>
<tr class="odd">
<td align="left">Conc4 - Conc0</td>
<td align="right">0.3056907</td>
<td align="right">0.5230995</td>
<td align="right">10</td>
<td align="right">0.5843835</td>
<td align="right">0.9619664</td>
<td align="right">-13.65123</td>
</tr>
<tr class="even">
<td align="left">Conc8 - Conc0</td>
<td align="right">-0.5944222</td>
<td align="right">0.5230995</td>
<td align="right">10</td>
<td align="right">-1.1363464</td>
<td align="right">0.6892705</td>
<td align="right">-40.63541</td>
</tr>
<tr class="odd">
<td align="left">Conc16 - Conc0</td>
<td align="right">-0.7426002</td>
<td align="right">0.5230995</td>
<td align="right">10</td>
<td align="right">-1.4196155</td>
<td align="right">0.5114138</td>
<td align="right">-50.88408</td>
</tr>
</tbody>
</table>
<ul>
<li>Further information about the normality test (Shapiro-Wilk), the
homogeneity of variance test (Levene’s test) of residuals of the mixed
ANOVA model, the monotonicity test and the model fit.</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">NormalityTest</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Shapiro-Wilk normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  stats::resid(mixedaov)</span></span>
<span><span class="co">#&gt; W = 0.99162, p-value = 0.03852</span></span>
<span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">LeveneTest</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;   statistic p.value    df df.residual</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     0.328   0.896     5         356</span></span>
<span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">`Monotonicity Test`</span></span>
<span><span class="co">#&gt;        Test t value Pr(&gt;|t|) Significance</span></span>
<span><span class="co">#&gt; 1    Linear   -1.49   0.1372            .</span></span>
<span><span class="co">#&gt; 2 Quadratic   -2.10   0.0364            *</span></span>
<span><span class="va">radar_spiked_result</span><span class="op">$</span><span class="va">MixedAnova</span></span>
<span><span class="co">#&gt; Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: </span></span>
<span><span class="co">#&gt; (Fluor^lambda - 1)/lambda ~ Conc + (1 | Replicate) + (1 | Replicate:Conc)</span></span>
<span><span class="co">#&gt;    Data: dataframe</span></span>
<span><span class="co">#&gt; REML criterion at convergence: 1790.386</span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups         Name        Std.Dev.</span></span>
<span><span class="co">#&gt;  Replicate:Conc (Intercept) 0.000   </span></span>
<span><span class="co">#&gt;  Replicate      (Intercept) 0.708   </span></span>
<span><span class="co">#&gt;  Residual                   2.865   </span></span>
<span><span class="co">#&gt; Number of obs: 362, groups:  Replicate:Conc, 18; Replicate, 3</span></span>
<span><span class="co">#&gt; Fixed Effects:</span></span>
<span><span class="co">#&gt; (Intercept)       Conc.L       Conc.Q       Conc.C       Conc^4       Conc^5  </span></span>
<span><span class="co">#&gt;    11.12517     -0.54062     -0.78033     -0.07106      0.90730     -0.34498  </span></span>
<span><span class="co">#&gt; optimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings</span></span></code></pre></div>
<p><em>The list output from running the data_prep() function can be
summarized with the data_summary() function.</em></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/data_summary.html">data_summary</a></span><span class="op">(</span><span class="va">radar_spiked_result</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">4</th>
<th align="left">8</th>
<th align="left">16</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Replicate 1</td>
<td align="left">-64.09</td>
<td align="left">37.28</td>
<td align="left">-23.92</td>
<td align="left">-74.73</td>
<td align="left">-68.52</td>
</tr>
<tr class="even">
<td align="left">Replicate 2</td>
<td align="left">-24.69</td>
<td align="left">-36.48</td>
<td align="left">5.55</td>
<td align="left">-33.52</td>
<td align="left">-40.11</td>
</tr>
<tr class="odd">
<td align="left">Replicate 3</td>
<td align="left">-28.69</td>
<td align="left">40.72</td>
<td align="left">-15.01</td>
<td align="left">-16.42</td>
<td align="left">-41.95</td>
</tr>
<tr class="even">
<td align="left">Pooled</td>
<td align="left">-39.72</td>
<td align="left">23.63</td>
<td align="left">-13.65</td>
<td align="left">-40.64</td>
<td align="left">-50.88</td>
</tr>
<tr class="odd">
<td align="left">Dunnett</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
</tr>
<tr class="even">
<td align="left">IncreasingWilliams</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
</tr>
<tr class="odd">
<td align="left">DecreasingWilliams</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="running-default-reactiv-analysis">Running default REACTIV analysis<a class="anchor" aria-label="anchor" href="#running-default-reactiv-analysis"></a>
</h2>
<p>To demonstrate how to run REACTIV analysis, we will use one
artificial data set containing the spiked and unspiked measurements.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reactiv_spiked</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="va"><a href="../reference/reactiv_data.html">reactiv_data</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Spiked</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">reactiv_unspiked</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="va"><a href="../reference/reactiv_data.html">reactiv_data</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Spiked</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The default REACTIV analysis can be run using the
<code><a href="../reference/data_prep.html">data_prep()</a></code> function with either spiked or unspiked data.
This function automatically decides whether trimming, outlier removal
and/or transformations are conducted following the manuscript
(Spyridonov et al. unpublished). The actual analysis is carried out by
the <code><a href="../reference/ana.html">ana()</a></code> function. The <code><a href="../reference/ana.html">ana()</a></code> function is
called by the <code><a href="../reference/data_prep.html">data_prep()</a></code> function and does not need to be
called separately. The analysis the REACTIV assay follows the
description of the Method 2 (the mixed ANOVA approach) in the Annex 8:
methods for the statistical analysis of REACTIV assay data of the
Amended Draft new Test Guideline for the REACTIV assay for second
WNT-review (<a href="https://www.oecd.org/chemicalsafety/testing/amended-draft-new-test-guideline-for-the-rapid-estrogen-ACTivity-in-vivo-assay.pdf" class="external-link">30.01.2024</a>).
For this assay, the <code>row</code> argument should be set to
<code>FALSE</code>. Trimming is not required. In case there are
residuals deviate from normality and variance homogeneity, outlier
removal (e.g. by applying the Tukey rule (Green et al., 2018) and data
transformation (for example log- or square-root) can be conducted.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">reactiv_spiked_result</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/data_prep.html">data_prep</a></span><span class="op">(</span>dataframe <span class="op">=</span> <span class="va">reactiv_spiked</span>, row <span class="op">=</span> <span class="cn">FALSE</span>, trimming<span class="op">=</span><span class="cn">FALSE</span>, boxcox <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">reactiv_unspiked_result</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/data_prep.html">data_prep</a></span><span class="op">(</span>dataframe <span class="op">=</span> <span class="va">reactiv_unspiked</span>, row<span class="op">=</span> <span class="cn">FALSE</span>, trimming<span class="op">=</span><span class="cn">FALSE</span>, boxcox <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Here we use the spiked data as an example to demonstrate the output
of the <code><a href="../reference/data_prep.html">data_prep()</a></code> function.</p>
<p>The outputs of the <code><a href="../reference/data_prep.html">data_prep()</a></code> function are lists
containing the following elements:</p>
<ul>
<li>A reasoning for the recommended transformation and trimming. The
data from which outliers were removed with the Tukey-rule where the
fluorescence values are square-root transformed, should be used for the
analysis because only after outlier removal and sqrt transformation, the
residuals of the mixed ANOVA are normally distributed and have
homogeneous variances among treatment groups</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">Justify</span></span>
<span><span class="co">#&gt; [1] "The data from which outliers were removed with the\n                    Tukey-rule where the fluorescence values are square-root\n                    transformed, should be used for the analysis because only\n                    after outlier removal and sqrt transformation, the\n                    residuals of the mixed ANOVA are normally distributed\n                    and have homogeneous variances among treatment groups"</span></span></code></pre></div>
<ul>
<li>A data frame of the processed data (e.g. raw data, transformed, or
outlier removed) used for actual statistical testing following the
reasoning. The box plots of the processed data per run/replicate
(i.e. each panel represents each run/replicate) are also provided for
visual inspection.</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">ProcessedData</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Replicate</th>
<th align="left">Conc</th>
<th align="right">Fluor</th>
<th align="left">Treatment</th>
<th align="left">Spiked</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">0</td>
<td align="right">1801520</td>
<td align="left">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0</td>
<td align="right">1517719</td>
<td align="left">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">0</td>
<td align="right">2517533</td>
<td align="left">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0</td>
<td align="right">3744706</td>
<td align="left">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">0</td>
<td align="right">2744990</td>
<td align="left">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0</td>
<td align="right">2889488</td>
<td align="left">0</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">BoxPlots</span></span></code></pre></div>
<p><img src="User_guide_files/figure-html/unnamed-chunk-24-1.png" width="672"></p>
<ul>
<li>Summary tables of the processed data (per replicate and
overall)</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">SummaryDF_Rep</span>, caption<span class="op">=</span><span class="st">"Summary statistics of fluorescence in different concentrations of test item per replicate"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Summary statistics of fluorescence in different concentrations
of test item per replicate</caption>
<colgroup>
<col width="7%">
<col width="14%">
<col width="4%">
<col width="12%">
<col width="26%">
<col width="35%">
</colgroup>
<thead><tr class="header">
<th align="left">Conc</th>
<th align="left">Replicate</th>
<th align="right">N</th>
<th align="right">Mean</th>
<th align="right">Standard deviation</th>
<th align="right">Coefficient of variation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">1</td>
<td align="right">16</td>
<td align="right">2486847</td>
<td align="right">1154357.6</td>
<td align="right">0.4641853</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">2</td>
<td align="right">16</td>
<td align="right">3341118</td>
<td align="right">797137.2</td>
<td align="right">0.2385839</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">3</td>
<td align="right">16</td>
<td align="right">2783708</td>
<td align="right">1049011.8</td>
<td align="right">0.3768398</td>
</tr>
<tr class="even">
<td align="left">0.16</td>
<td align="left">1</td>
<td align="right">8</td>
<td align="right">2748986</td>
<td align="right">550546.7</td>
<td align="right">0.2002727</td>
</tr>
<tr class="odd">
<td align="left">0.16</td>
<td align="left">2</td>
<td align="right">8</td>
<td align="right">2382941</td>
<td align="right">636560.2</td>
<td align="right">0.2671321</td>
</tr>
<tr class="even">
<td align="left">0.16</td>
<td align="left">3</td>
<td align="right">8</td>
<td align="right">2705488</td>
<td align="right">981794.9</td>
<td align="right">0.3628901</td>
</tr>
<tr class="odd">
<td align="left">0.8</td>
<td align="left">1</td>
<td align="right">8</td>
<td align="right">2683131</td>
<td align="right">1093419.6</td>
<td align="right">0.4075163</td>
</tr>
<tr class="even">
<td align="left">0.8</td>
<td align="left">2</td>
<td align="right">8</td>
<td align="right">2567366</td>
<td align="right">412800.9</td>
<td align="right">0.1607877</td>
</tr>
<tr class="odd">
<td align="left">0.8</td>
<td align="left">3</td>
<td align="right">8</td>
<td align="right">2860645</td>
<td align="right">499925.0</td>
<td align="right">0.1747595</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">1</td>
<td align="right">8</td>
<td align="right">2885645</td>
<td align="right">850608.9</td>
<td align="right">0.2947725</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="left">2</td>
<td align="right">8</td>
<td align="right">3581072</td>
<td align="right">837331.5</td>
<td align="right">0.2338214</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">3</td>
<td align="right">8</td>
<td align="right">2870297</td>
<td align="right">644055.0</td>
<td align="right">0.2243862</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="left">1</td>
<td align="right">6</td>
<td align="right">6389817</td>
<td align="right">1455541.4</td>
<td align="right">0.2277908</td>
</tr>
<tr class="even">
<td align="left">20</td>
<td align="left">2</td>
<td align="right">7</td>
<td align="right">6142859</td>
<td align="right">1499704.2</td>
<td align="right">0.2441378</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="left">3</td>
<td align="right">7</td>
<td align="right">6533288</td>
<td align="right">1256422.3</td>
<td align="right">0.1923109</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="left">1</td>
<td align="right">5</td>
<td align="right">10533255</td>
<td align="right">1668866.7</td>
<td align="right">0.1584379</td>
</tr>
<tr class="odd">
<td align="left">100</td>
<td align="left">2</td>
<td align="right">4</td>
<td align="right">10248429</td>
<td align="right">1982668.2</td>
<td align="right">0.1934607</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="left">3</td>
<td align="right">4</td>
<td align="right">9080113</td>
<td align="right">1215680.9</td>
<td align="right">0.1338839</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">SummaryDF</span>, caption<span class="op">=</span><span class="st">"Summary statistics of fluorescence in different concentrations of test item of all replicates"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Summary statistics of fluorescence in different concentrations
of test item of all replicates</caption>
<thead><tr class="header">
<th align="left">Conc</th>
<th align="right">N</th>
<th align="right">Mean</th>
<th align="right">Standard deviation</th>
<th align="right">Coefficient of variation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="right">48</td>
<td align="right">2870558</td>
<td align="right">1052304.4</td>
<td align="right">0.3665854</td>
</tr>
<tr class="even">
<td align="left">0.16</td>
<td align="right">24</td>
<td align="right">2612472</td>
<td align="right">732636.7</td>
<td align="right">0.2804381</td>
</tr>
<tr class="odd">
<td align="left">0.8</td>
<td align="right">24</td>
<td align="right">2703714</td>
<td align="right">712021.2</td>
<td align="right">0.2633493</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">24</td>
<td align="right">3112338</td>
<td align="right">821286.1</td>
<td align="right">0.2638807</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="right">20</td>
<td align="right">6353596</td>
<td align="right">1339757.0</td>
<td align="right">0.2108659</td>
</tr>
<tr class="even">
<td align="left">100</td>
<td align="right">13</td>
<td align="right">9998496</td>
<td align="right">1643685.7</td>
<td align="right">0.1643933</td>
</tr>
</tbody>
</table>
<ul>
<li>Tables of results evaluated using increasing/decreasing Williams
test and/or Dunnett’s test, if applicable.</li>
</ul>
<p>In the Williams’ test result tables, <em>Y.Tilde</em> is the
amalgamated mean of the fluorescence in each treatment group,
<em>Y0</em> is the mean of the control fluorescence, <em>DIFF</em> is
the estimated difference between the treatment and the control,
<em>SE_DIFF</em> is the standard error of the Williams’ test,
<em>DF</em> is the degrees of freedom for Williams’ test, <em>WILL
Incr</em> or <em>Will Decr</em> is the Williams’ test statistic,
<em>crit Val</em> is the critical value of Williams distribution,
<em>Sign</em> suggests if there is significant difference between the
treatment and the control, and <em>%Incr</em> is the percent increase of
the fluorescence compared to the control.</p>
<p>In the Dunnett’s test result table, <em>Estimate</em> is the
estimated difference between the treatment and the control, <em>SE</em>
is the standard error of the mixed ANOVA model, <em>t value</em> is the
Dunnett’s test statistic, <em>adj p</em> is the adjusted p value and
<em>%Incr</em> is the percent increase of the fluorescence compared to
the control.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">WilliamsIncrease</span>, caption<span class="op">=</span><span class="st">"Increasing Williams' test"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Increasing Williams’ test</caption>
<colgroup>
<col width="17%">
<col width="5%">
<col width="8%">
<col width="9%">
<col width="11%">
<col width="9%">
<col width="3%">
<col width="11%">
<col width="9%">
<col width="6%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Conc</th>
<th align="right">Y.Tilde</th>
<th align="right">Y0</th>
<th align="right">DIFF Incr</th>
<th align="right">SE_DIFF</th>
<th align="right">DF</th>
<th align="right">WILL Incr</th>
<th align="right">crit Val</th>
<th align="left">Sign</th>
<th align="right">% Incr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conc100 - Conc0</td>
<td align="left">100</td>
<td align="right">3152.32</td>
<td align="right">1661.366</td>
<td align="right">1490.95383</td>
<td align="right">97.89606</td>
<td align="right">9</td>
<td align="right">15.2299684</td>
<td align="right">1.998</td>
<td align="left">TRUE</td>
<td align="right">248.311979</td>
</tr>
<tr class="even">
<td align="left">Conc20 - Conc0</td>
<td align="left">20</td>
<td align="right">2506.80</td>
<td align="right">1661.366</td>
<td align="right">845.43383</td>
<td align="right">87.04570</td>
<td align="right">9</td>
<td align="right">9.7125278</td>
<td align="right">1.991</td>
<td align="left">TRUE</td>
<td align="right">121.336658</td>
</tr>
<tr class="odd">
<td align="left">Conc4 - Conc0</td>
<td align="left">4</td>
<td align="right">1748.86</td>
<td align="right">1661.366</td>
<td align="right">87.49383</td>
<td align="right">83.38750</td>
<td align="right">9</td>
<td align="right">1.0492440</td>
<td align="right">1.981</td>
<td align="left">FALSE</td>
<td align="right">8.422775</td>
</tr>
<tr class="even">
<td align="left">Conc0.8 - Conc0</td>
<td align="left">0.8</td>
<td align="right">1629.52</td>
<td align="right">1661.366</td>
<td align="right">-31.84617</td>
<td align="right">83.38750</td>
<td align="right">9</td>
<td align="right">-0.3819058</td>
<td align="right">1.965</td>
<td align="left">FALSE</td>
<td align="right">-5.812226</td>
</tr>
<tr class="odd">
<td align="left">Conc0.16 - Conc0</td>
<td align="left">0.16</td>
<td align="right">1598.55</td>
<td align="right">1661.366</td>
<td align="right">-62.81617</td>
<td align="right">83.38750</td>
<td align="right">9</td>
<td align="right">-0.7533044</td>
<td align="right">1.931</td>
<td align="left">FALSE</td>
<td align="right">-8.990784</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">WilliamsDecrease</span>, caption<span class="op">=</span><span class="st">"Decreasing Williams' test"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Decreasing Williams’ test</caption>
<colgroup>
<col width="17%">
<col width="5%">
<col width="8%">
<col width="9%">
<col width="10%">
<col width="9%">
<col width="3%">
<col width="10%">
<col width="9%">
<col width="6%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Conc</th>
<th align="right">Y.Tilde</th>
<th align="right">Y0</th>
<th align="right">DIFF Decr</th>
<th align="right">SE_DIFF</th>
<th align="right">DF</th>
<th align="right">WILL Decr</th>
<th align="right">crit Val</th>
<th align="left">Sign</th>
<th align="right">% Incr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conc100 - Conc0</td>
<td align="left">100</td>
<td align="right">2007.29</td>
<td align="right">1661.366</td>
<td align="right">-345.9238</td>
<td align="right">97.89606</td>
<td align="right">9</td>
<td align="right">-3.533583</td>
<td align="right">1.998</td>
<td align="left">FALSE</td>
<td align="right">248.311979</td>
</tr>
<tr class="even">
<td align="left">Conc20 - Conc0</td>
<td align="left">20</td>
<td align="right">2007.29</td>
<td align="right">1661.366</td>
<td align="right">-345.9238</td>
<td align="right">87.04570</td>
<td align="right">9</td>
<td align="right">-3.974048</td>
<td align="right">1.991</td>
<td align="left">FALSE</td>
<td align="right">121.336658</td>
</tr>
<tr class="odd">
<td align="left">Conc4 - Conc0</td>
<td align="left">4</td>
<td align="right">2007.29</td>
<td align="right">1661.366</td>
<td align="right">-345.9238</td>
<td align="right">83.38750</td>
<td align="right">9</td>
<td align="right">-4.148390</td>
<td align="right">1.981</td>
<td align="left">FALSE</td>
<td align="right">8.422775</td>
</tr>
<tr class="even">
<td align="left">Conc0.8 - Conc0</td>
<td align="left">0.8</td>
<td align="right">2007.29</td>
<td align="right">1661.366</td>
<td align="right">-345.9238</td>
<td align="right">83.38750</td>
<td align="right">9</td>
<td align="right">-4.148390</td>
<td align="right">1.965</td>
<td align="left">FALSE</td>
<td align="right">-5.812226</td>
</tr>
<tr class="odd">
<td align="left">Conc0.16 - Conc0</td>
<td align="left">0.16</td>
<td align="right">2007.29</td>
<td align="right">1661.366</td>
<td align="right">-345.9238</td>
<td align="right">83.38750</td>
<td align="right">9</td>
<td align="right">-4.148390</td>
<td align="right">1.931</td>
<td align="left">FALSE</td>
<td align="right">-8.990784</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">Dunnetts</span>, caption<span class="op">=</span><span class="st">"Dunnett's test"</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>Dunnett’s test</caption>
<colgroup>
<col width="23%">
<col width="15%">
<col width="12%">
<col width="4%">
<col width="15%">
<col width="13%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t value</th>
<th align="right">adj p</th>
<th align="right">% Incr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Conc0.16 - Conc0</td>
<td align="right">-62.81884</td>
<td align="right">83.38750</td>
<td align="right">9</td>
<td align="right">-0.7533364</td>
<td align="right">0.9231737</td>
<td align="right">-8.990784</td>
</tr>
<tr class="even">
<td align="left">Conc0.8 - Conc0</td>
<td align="right">-31.84356</td>
<td align="right">83.38750</td>
<td align="right">9</td>
<td align="right">-0.3818746</td>
<td align="right">0.9953441</td>
<td align="right">-5.812226</td>
</tr>
<tr class="odd">
<td align="left">Conc4 - Conc0</td>
<td align="right">87.49635</td>
<td align="right">83.38750</td>
<td align="right">9</td>
<td align="right">1.0492743</td>
<td align="right">0.7798328</td>
<td align="right">8.422775</td>
</tr>
<tr class="even">
<td align="left">Conc20 - Conc0</td>
<td align="right">845.49890</td>
<td align="right">87.04570</td>
<td align="right">9</td>
<td align="right">9.7132754</td>
<td align="right">0.0000051</td>
<td align="right">121.336658</td>
</tr>
<tr class="odd">
<td align="left">Conc100 - Conc0</td>
<td align="right">1489.69562</td>
<td align="right">97.89606</td>
<td align="right">9</td>
<td align="right">15.2171158</td>
<td align="right">0.0000000</td>
<td align="right">248.311979</td>
</tr>
</tbody>
</table>
<ul>
<li>Further information about the normality test (Shapiro-Wilk), the
homogeneity of variance test (Levene’s test) of residuals of the mixed
ANOVA model, the monotonicity test and the model fit.</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">NormalityTest</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Shapiro-Wilk normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  stats::resid(mixedaov)</span></span>
<span><span class="co">#&gt; W = 0.98187, p-value = 0.04164</span></span>
<span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">LeveneTest</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;   statistic p.value    df df.residual</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1.59   0.167     5         147</span></span>
<span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">`Monotonicity Test`</span></span>
<span><span class="co">#&gt;        Test t value Pr(&gt;|t|) Significance</span></span>
<span><span class="co">#&gt; 1    Linear   12.67  &lt;0.0001          ***</span></span>
<span><span class="co">#&gt; 2 Quadratic    6.66  &lt;0.0001          ***</span></span>
<span><span class="va">reactiv_spiked_result</span><span class="op">$</span><span class="va">MixedAnova</span></span>
<span><span class="co">#&gt; Linear mixed model fit by REML ['lmerMod']</span></span>
<span><span class="co">#&gt; Formula: sqrt(Fluor) ~ Conc + (1 | Replicate) + (1 | Replicate:Conc)</span></span>
<span><span class="co">#&gt;    Data: wt_outlier</span></span>
<span><span class="co">#&gt; REML criterion at convergence: 2090.548</span></span>
<span><span class="co">#&gt; Random effects:</span></span>
<span><span class="co">#&gt;  Groups         Name        Std.Dev. </span></span>
<span><span class="co">#&gt;  Replicate:Conc (Intercept)  58.87516</span></span>
<span><span class="co">#&gt;  Replicate      (Intercept)   0.01916</span></span>
<span><span class="co">#&gt;  Residual                   272.54703</span></span>
<span><span class="co">#&gt; Number of obs: 153, groups:  Replicate:Conc, 18; Replicate, 3</span></span>
<span><span class="co">#&gt; Fixed Effects:</span></span>
<span><span class="co">#&gt; (Intercept)       Conc.L       Conc.Q       Conc.C       Conc^4       Conc^5  </span></span>
<span><span class="co">#&gt;     2049.37      1230.22       703.01        45.68      -141.18      -117.07  </span></span>
<span><span class="co">#&gt; optimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings</span></span></code></pre></div>
<p><em>The list output from running the data_prep() function can be
summarized with the data_summary() function.</em></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/data_summary.html">data_summary</a></span><span class="op">(</span><span class="va">reactiv_spiked_result</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">0.16</th>
<th align="left">0.8</th>
<th align="left">4</th>
<th align="left">20</th>
<th align="left">100</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Replicate 1</td>
<td align="left">10.54</td>
<td align="left">7.89</td>
<td align="left">16.04</td>
<td align="left">156.94</td>
<td align="left">323.56</td>
</tr>
<tr class="even">
<td align="left">Replicate 2</td>
<td align="left">-28.68</td>
<td align="left">-23.16</td>
<td align="left">7.18</td>
<td align="left">83.86</td>
<td align="left">206.74</td>
</tr>
<tr class="odd">
<td align="left">Replicate 3</td>
<td align="left">-2.81</td>
<td align="left">2.76</td>
<td align="left">3.11</td>
<td align="left">134.7</td>
<td align="left">226.19</td>
</tr>
<tr class="even">
<td align="left">Pooled</td>
<td align="left">-8.99</td>
<td align="left">-5.81</td>
<td align="left">8.42</td>
<td align="left">121.34</td>
<td align="left">248.31</td>
</tr>
<tr class="odd">
<td align="left">Dunnett</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">*</td>
<td align="left">*</td>
</tr>
<tr class="even">
<td align="left">IncreasingWilliams</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">*</td>
<td align="left">*</td>
</tr>
<tr class="odd">
<td align="left">DecreasingWilliams</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
<td align="left">ns</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="validation">Validation<a class="anchor" aria-label="anchor" href="#validation"></a>
</h2>
<p>In order to validate the package, we will analyze all 36 XETA ring
test studies and produce a table that can be compared with the table in
the validation report. The validation studies are available in the
<code>xeredar</code> package. In case the produced table is in line with
the table description, then the package is doing exactly what it is
supposed to do and analyzed all 36 XETA ring test studies correctly.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span>  <span class="op">!</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringr/man/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu">xeredar</span><span class="fu">::</span><span class="va"><a href="../reference/valid_data_xeta.html">valid_data_xeta</a></span><span class="op">)</span>, <span class="st">"_combined$"</span> <span class="op">)</span></span>
<span><span class="va">list_dfs</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="va"><a href="../reference/valid_data_xeta.html">valid_data_xeta</a></span><span class="op">[</span><span class="va">out</span><span class="op">]</span></span>
<span><span class="va">data_prep_trim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Fluor</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">dat_trim</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/trim.html">trim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">$</span><span class="va">dat_trim</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/data_prep.html">data_prep</a></span><span class="op">(</span><span class="va">dat_trim</span>, row<span class="op">=</span> <span class="cn">FALSE</span>, trim<span class="op">=</span><span class="cn">FALSE</span>, outlier <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">list_dfs</span>, <span class="va">data_prep_trim</span>,  .progress <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">worked</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map_vec</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">is.list</span><span class="op">)</span></span>
<span></span>
<span><span class="va">difficult_dfs</span> <span class="op">&lt;-</span> <span class="va">list_dfs</span><span class="op">[</span><span class="va">worked</span><span class="op">]</span></span>
<span></span>
<span><span class="va">changing_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/outer.html" class="external-link">%o%</a></span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">17</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">decreasing_alpha</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">vector</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">vector</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Fluor</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">dat_trim</span> <span class="op">&lt;-</span> <span class="fu">xeredar</span><span class="fu">::</span><span class="fu"><a href="../reference/trim.html">trim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">$</span><span class="va">dat_trim</span></span>
<span>    <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/data_prep.html">data_prep</a></span><span class="op">(</span><span class="va">df</span>, row<span class="op">=</span><span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="va">i</span>, trim<span class="op">=</span><span class="cn">FALSE</span>, outlier <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">is.list</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw">break</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>      <span class="kw">next</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">result</span><span class="op">[[</span><span class="st">"alpha"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">result_difficult_dfs</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">difficult_dfs</span>, .f<span class="op">=</span> <span class="va">decreasing_alpha</span>, vector <span class="op">=</span> <span class="va">changing_alpha</span><span class="op">)</span></span>
<span><span class="va">results_alpha_decrease</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[</span><span class="fu">map_vec</span><span class="op">(</span><span class="va">results</span>, <span class="va">is.list</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">results_alpha_decrease</span>, <span class="va">result_difficult_dfs</span><span class="op">)</span></span>
<span><span class="va">check_positive</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="st">"Monotonicity Test"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`Pr(&gt;|t|)`</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="fl">0.01</span> <span class="op">&amp;</span></span>
<span>     <span class="va">df</span><span class="op">[[</span><span class="st">"Monotonicity Test"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`Pr(&gt;|t|)`</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">0.01</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="st">"Dunnetts"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">WilliamsIncrease</span><span class="op">$</span><span class="va">Y.Tilde</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">WilliamsIncrease</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">|</span> </span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">WilliamsDecrease</span><span class="op">$</span><span class="va">Y.Tilde</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">WilliamsDecrease</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>WilliamsIncrease <span class="op">=</span> <span class="va">df</span><span class="op">[[</span><span class="st">"WilliamsIncrease"</span><span class="op">]</span><span class="op">]</span>, WilliamsDecrease <span class="op">=</span> <span class="va">df</span><span class="op">[[</span><span class="st">"WilliamsDecrease"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="st">"Dunnetts"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">results_2</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">check_positive</span><span class="op">)</span></span>
<span><span class="va">Williams</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map_vec</a></span><span class="op">(</span><span class="va">results_2</span>, <span class="va">is.data.frame</span><span class="op">)</span></span>
<span></span>
<span><span class="va">significances</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">Williams</span><span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">Williams</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">WilliamsIncrease</span><span class="op">$</span><span class="va">Y.Tilde</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">&gt;</span> </span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">WilliamsIncrease</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="cn">TRUE</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">df</span><span class="op">[[</span><span class="st">"WilliamsIncrease"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Sign</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>      <span class="cn">TRUE</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">df</span><span class="op">[[</span><span class="st">"WilliamsDecrease"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Sign</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">df</span><span class="op">[[</span><span class="st">"adj p"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="st">"adj p"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.05</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">prelim_thyroid_active</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map2.html" class="external-link">map2_vec</a></span><span class="op">(</span><span class="va">results_2</span>, <span class="va">Williams</span>, <span class="va">significances</span><span class="op">)</span></span>
<span></span>
<span><span class="va">country_substance_spiked</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results_2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringr/man/str_split.html" class="external-link">str_split</a></span><span class="op">(</span><span class="st">"\\_"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tibble/man/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"substance"</span> <span class="op">=</span> <span class="st">"V1"</span>, <span class="st">"country"</span> <span class="op">=</span> <span class="st">"V2"</span>, <span class="st">"spiked"</span> <span class="op">=</span> <span class="st">"V3"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Sign <span class="op">=</span> <span class="va">prelim_thyroid_active</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">increase_h12</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op">|&gt;</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/purrr/man/map.html" class="external-link">map_vec</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"SummaryDF"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Mean</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"SummaryDF"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">[[</span><span class="st">"SummaryDF"</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span> <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">thyroid_active</span> <span class="op">&lt;-</span> <span class="va">country_substance_spiked</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Increase <span class="op">=</span> <span class="va">increase_h12</span>,</span>
<span>                                                            thyroid_active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Increase</span> <span class="op">&gt;=</span> <span class="fl">0.12</span> <span class="op">&amp;</span> <span class="va">Sign</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">&amp;</span> <span class="va">spiked</span> <span class="op">==</span> <span class="st">"unspiked"</span> <span class="op">|</span></span>
<span>                                                                                      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Increase</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0.12</span> <span class="op">&amp;</span> <span class="va">Sign</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">&amp;</span> <span class="va">spiked</span> <span class="op">==</span> <span class="st">"spiked"</span> , <span class="st">"Thyroid active"</span>, <span class="st">"Thyroid inactive"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">!</span><span class="va">Sign</span>, <span class="op">!</span><span class="va">Increase</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>thyroid_active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="st">"Thyroid active"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">thyroid_active</span>, <span class="st">"Thyroid active"</span>, <span class="st">"Thyroid inactive"</span><span class="op">)</span>, .by<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">substance</span>, <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">country</span><span class="op">==</span> <span class="st">"japan"</span> <span class="op">&amp;</span> <span class="va">substance</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"e2"</span>, <span class="st">"nh3"</span><span class="op">)</span> <span class="op">|</span></span>
<span>                       <span class="va">country</span> <span class="op">==</span> <span class="st">"japan2"</span>, <span class="st">"japan lab2"</span>, <span class="va">country</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">country</span>, values_from <span class="op">=</span> <span class="va">thyroid_active</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">substance</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t3"</span>, <span class="st">"ptu"</span>, <span class="st">"t4"</span>, <span class="st">"triac"</span>, <span class="st">"cefuroxime"</span>,<span class="st">"linuron"</span>, <span class="st">"nh3"</span>, <span class="st">"testosterone"</span>,<span class="st">"e2"</span>, <span class="st">"abamectine"</span>, <span class="st">"acetone"</span>, <span class="st">"isophorone"</span>, <span class="st">"metholmyl"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>`Expected classification`<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Thyroid active"</span>, <span class="st">"Thyroid active"</span>, <span class="st">"Thyroid active"</span>, <span class="st">"Thyroid active"</span>, <span class="st">"Thyroid inactive"</span>, <span class="st">"Thyroid active"</span>, <span class="st">"Thyroid active"</span>, <span class="st">"Unclear"</span>, <span class="st">"Thyroid inactive"</span>, <span class="st">"Thyroid inactive"</span>,<span class="st">"Thyroid inactive"</span>,<span class="st">"Thyroid inactive"</span>,<span class="st">"Thyroid inactive"</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">substance</span>,<span class="va">`Expected classification`</span>, <span class="va">france</span>,<span class="va">japan</span>, <span class="va">usa</span>, <span class="va">`japan lab2`</span>, <span class="va">belgium</span>, <span class="va">portugal</span> <span class="op">)</span><span class="op">)</span>  <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/rename.html" class="external-link">rename</a></span><span class="op">(</span>USA <span class="op">=</span> <span class="va">usa</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gt/man/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="va">thyroid_active</span>, rowname_col <span class="op">=</span> <span class="st">"substance"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gt/man/tab_options.html" class="external-link">tab_options</a></span><span class="op">(</span>column_labels.text_transform <span class="op">=</span> <span class="st">"capitalize"</span>,</span>
<span>              stub.text_transform <span class="op">=</span> <span class="st">"uppercase"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gt/man/data_color.html" class="external-link">data_color</a></span><span class="op">(</span>columns<span class="op">=</span> <span class="op">-</span><span class="va">substance</span>, na_color <span class="op">=</span> <span class="st">"white"</span>, palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#c2cd94"</span>, <span class="st">"#b4c6e7"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gt/man/tab_stubhead.html" class="external-link">tab_stubhead</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Chemical"</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gt/man/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="st">"Laboratory"</span>,</span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">france</span>, <span class="va">japan</span>, <span class="va">USA</span>, <span class="st">'japan lab2'</span>, <span class="va">belgium</span>, <span class="va">portugal</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gt/man/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gt/man/cell_text.html" class="external-link">cell_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#D9654B"</span>, weight<span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gt/man/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span></span>
<span>      columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">france</span>, <span class="va">belgium</span><span class="op">)</span>, <span class="co"># not needed if coloring all columns</span></span>
<span>      rows <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span>  <span class="op">)</span>  <span class="op">|&gt;</span> </span>
<span>   <span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gt/man/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Summary table of results from statistical analysis of all 36 validation studies of the ring test of the XETA test guideline. This table shows the results of the automatic analysis carried out with the data_prep() function of the xeredar R-package. Furthermore, this table summarises the results of the original analysis carried out by John Green using SAS. As both approaches led to exactly the same conclusions, only one table is shown. In case a substance was identified to be Thyroid active, the respective cell is colored green, whereas when a substance was identified to be Thyroid inactive, the cell was colored blue. For the study applying testosterone in the french lab, the writing is colored red, because in the original table in the validation document, this substance was incorrectly classified as Thyroid active due to a data transfer mistake. Furthermore, for the study applying testosterone in the belgium lab, the writing is colored red, as well, because in the validation document, a slip in the column led to incorrectly categorizing the respective results as carried out by the japanese lab2."</span><span class="op">)</span></span></code></pre></div>
<div id="cwcpbowcig" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cwcpbowcig table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cwcpbowcig thead, #cwcpbowcig tbody, #cwcpbowcig tfoot, #cwcpbowcig tr, #cwcpbowcig td, #cwcpbowcig th {
  border-style: none;
}

#cwcpbowcig p {
  margin: 0;
  padding: 0;
}

#cwcpbowcig .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cwcpbowcig .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cwcpbowcig .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cwcpbowcig .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cwcpbowcig .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cwcpbowcig .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cwcpbowcig .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cwcpbowcig .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: capitalize;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cwcpbowcig .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: capitalize;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cwcpbowcig .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cwcpbowcig .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cwcpbowcig .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cwcpbowcig .gt_spanner_row {
  border-bottom-style: hidden;
}

#cwcpbowcig .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cwcpbowcig .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cwcpbowcig .gt_from_md > :first-child {
  margin-top: 0;
}

#cwcpbowcig .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cwcpbowcig .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cwcpbowcig .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cwcpbowcig .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cwcpbowcig .gt_row_group_first td {
  border-top-width: 2px;
}

#cwcpbowcig .gt_row_group_first th {
  border-top-width: 2px;
}

#cwcpbowcig .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cwcpbowcig .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cwcpbowcig .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cwcpbowcig .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cwcpbowcig .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cwcpbowcig .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cwcpbowcig .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cwcpbowcig .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cwcpbowcig .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cwcpbowcig .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cwcpbowcig .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cwcpbowcig .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cwcpbowcig .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cwcpbowcig .gt_left {
  text-align: left;
}

#cwcpbowcig .gt_center {
  text-align: center;
}

#cwcpbowcig .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cwcpbowcig .gt_font_normal {
  font-weight: normal;
}

#cwcpbowcig .gt_font_bold {
  font-weight: bold;
}

#cwcpbowcig .gt_font_italic {
  font-style: italic;
}

#cwcpbowcig .gt_super {
  font-size: 65%;
}

#cwcpbowcig .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cwcpbowcig .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cwcpbowcig .gt_indent_1 {
  text-indent: 5px;
}

#cwcpbowcig .gt_indent_2 {
  text-indent: 10px;
}

#cwcpbowcig .gt_indent_3 {
  text-indent: 15px;
}

#cwcpbowcig .gt_indent_4 {
  text-indent: 20px;
}

#cwcpbowcig .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="8" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Summary table of results from statistical analysis of all 36 validation studies of the ring test of the XETA test guideline. This table shows the results of the automatic analysis carried out with the data_prep() function of the xeredar R-package. Furthermore, this table summarises the results of the original analysis carried out by John Green using SAS. As both approaches led to exactly the same conclusions, only one table is shown. In case a substance was identified to be Thyroid active, the respective cell is colored green, whereas when a substance was identified to be Thyroid inactive, the cell was colored blue. For the study applying testosterone in the french lab, the writing is colored red, because in the original table in the validation document, this substance was incorrectly classified as Thyroid active due to a data transfer mistake. Furthermore, for the study applying testosterone in the belgium lab, the writing is colored red, as well, because in the validation document, a slip in the column led to incorrectly categorizing the respective results as carried out by the japanese lab2.</td>
    </tr>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Chemical">Chemical</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Expected classification">Expected classification</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="6" scope="colgroup" id="Laboratory">
        <span class="gt_column_spanner">Laboratory</span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="france">france</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="japan">japan</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="USA">USA</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="japan lab2">japan lab2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="belgium">belgium</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="portugal">portugal</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<th id="stub_1_1" scope="row" class="gt_row gt_left gt_stub">t3</th>
<td headers="stub_1_1 Expected classification" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_1 france" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_1 japan" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_1 USA" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_1 japan lab2" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_1 belgium" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_1 portugal" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
</tr>
<tr>
<th id="stub_1_2" scope="row" class="gt_row gt_left gt_stub">ptu</th>
<td headers="stub_1_2 Expected classification" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_2 france" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_2 japan" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_2 USA" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_2 japan lab2" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_2 belgium" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_2 portugal" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
</tr>
<tr>
<th id="stub_1_3" scope="row" class="gt_row gt_left gt_stub">t4</th>
<td headers="stub_1_3 Expected classification" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_3 france" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_3 japan" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_3 USA" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_3 japan lab2" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_3 belgium" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_3 portugal" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
</tr>
<tr>
<th id="stub_1_4" scope="row" class="gt_row gt_left gt_stub">triac</th>
<td headers="stub_1_4 Expected classification" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_4 france" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_4 japan" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_4 USA" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_4 japan lab2" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_4 belgium" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_4 portugal" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
</tr>
<tr>
<th id="stub_1_5" scope="row" class="gt_row gt_left gt_stub">cefuroxime</th>
<td headers="stub_1_5 Expected classification" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_5 france" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_5 japan" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_5 USA" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_5 japan lab2" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_5 belgium" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_5 portugal" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
</tr>
<tr>
<th id="stub_1_6" scope="row" class="gt_row gt_left gt_stub">linuron</th>
<td headers="stub_1_6 Expected classification" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_6 france" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_6 japan" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_6 USA" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_6 japan lab2" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_6 belgium" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_6 portugal" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
</tr>
<tr>
<th id="stub_1_7" scope="row" class="gt_row gt_left gt_stub">nh3</th>
<td headers="stub_1_7 Expected classification" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_7 france" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_7 japan" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_7 USA" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_7 japan lab2" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
<td headers="stub_1_7 belgium" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_7 portugal" class="gt_row gt_left" style="background-color: #C2CD94; color: #000000;">Thyroid active</td>
</tr>
<tr>
<th id="stub_1_8" scope="row" class="gt_row gt_left gt_stub">testosterone</th>
<td headers="stub_1_8 Expected classification" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">Unclear</td>
<td headers="stub_1_8 france" class="gt_row gt_left" style="background-color: #B4C6E7; color: #D9654B; font-weight: bold;">Thyroid inactive</td>
<td headers="stub_1_8 japan" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_8 USA" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_8 japan lab2" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_8 belgium" class="gt_row gt_left" style="background-color: #B4C6E7; color: #D9654B; font-weight: bold;">Thyroid inactive</td>
<td headers="stub_1_8 portugal" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
</tr>
<tr>
<th id="stub_1_9" scope="row" class="gt_row gt_left gt_stub">e2</th>
<td headers="stub_1_9 Expected classification" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_9 france" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_9 japan" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_9 USA" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_9 japan lab2" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_9 belgium" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_9 portugal" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
</tr>
<tr>
<th id="stub_1_10" scope="row" class="gt_row gt_left gt_stub">acetone</th>
<td headers="stub_1_10 Expected classification" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_10 france" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_10 japan" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_10 USA" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_10 japan lab2" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_10 belgium" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_10 portugal" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
</tr>
<tr>
<th id="stub_1_11" scope="row" class="gt_row gt_left gt_stub">isophorone</th>
<td headers="stub_1_11 Expected classification" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_11 france" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_11 japan" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_11 USA" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_11 japan lab2" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_11 belgium" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_11 portugal" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
</tr>
<tr>
<th id="stub_1_12" scope="row" class="gt_row gt_left gt_stub">abamactine</th>
<td headers="stub_1_12 Expected classification" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_12 france" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_12 japan" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_12 USA" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_12 japan lab2" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_12 belgium" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_12 portugal" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
</tr>
<tr>
<th id="stub_1_13" scope="row" class="gt_row gt_left gt_stub">methomyl</th>
<td headers="stub_1_13 Expected classification" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_13 france" class="gt_row gt_left" style="background-color: #B4C6E7; color: #000000;">Thyroid inactive</td>
<td headers="stub_1_13 japan" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_13 USA" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_13 japan lab2" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_13 belgium" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
<td headers="stub_1_13 portugal" class="gt_row gt_left" style="background-color: #FFFFFF; color: #000000;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>OECD. 2019a. Validation Report of the Xenopus Eleutheroembryonic
Thyroid Signaling Assay (XETA) for the Detection of Thyroid Active
Substances. OECD.</p>
<p>OECD. 2019b. TG 248: Xenopus Eleutheroembryonic Thyroid Assay (XETA).
OECD. <a href="https://doi.org/10.1787/a13f80ee-en" class="external-link uri">https://doi.org/10.1787/a13f80ee-en</a>.</p>
<p>OECD. 2022b. Test No. 251: Rapid Androgen Disruption Activity
Reporter (RADAR) Assay. OECD. <a href="https://doi.org/10.1787/da264d82-en" class="external-link uri">https://doi.org/10.1787/da264d82-en</a>.</p>
<p>OECD. 2022a. Rapid Estrogen Activity in Vivo (REACTIV) Assay (OECD
Draft TG): Guideline for the Testing of Chemicals, Section 2: Effects on
Biotic System. OECD.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Inka Marie Spyridonov, Lijuan Yan, Eduard Szoecs.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
